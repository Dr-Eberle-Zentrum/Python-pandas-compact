<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="de" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Python pandas - kompakt: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav UT"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="UT-logo" alt="Universität Tübingen" src="../assets/images/UT-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav UT" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Universität Tübingen" src="../assets/images/UT-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Python pandas - kompakt
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Python pandas - kompakt
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Generelles</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Python pandas - kompakt
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress UT">
    <div class="progress-bar UT" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="Datenstrukturen.html">1. Datenstrukturen</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="Datenimport.html">2. Datenimport aus Dateien</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="Datenverarbeitung.html">3. Datenverarbeitung</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="Visualisierung.html">4. Visualisierung</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Generelles</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-Datenstrukturen"><p>Content from <a href="Datenstrukturen.html">Datenstrukturen</a></p>
<hr>
<p>Last updated on 2024-10-08 |

        <a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/edit/main/episodes/Datenstrukturen.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Welche Datenarten gibt es?</li>
<li>Wie organisiere ich tabellarische Daten?</li>
<li>Was sind “tidy” Daten?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Standarddatentypen in Python</li>
<li>DataFrames für tabellarische Daten</li>
<li>Konzept der “tidy” Daten</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Wir gehen in diesem Modul davon aus, dass Sie die Grundlagen der
Python-Programmierung kennen, insbesondere - die Verwendung von
Variablen, Listen und Schleifen´, - die Verwendung von Funktionen und
Methoden, - die Verwendung von Paketen und Modulen, - die Verwendung
eingebauter Datenstrukturen wie <code>list</code>, <code>dict</code> und
<code>set</code>.</p>
<p>Wenn Sie sich nicht sicher sind, können Sie gerne eines der
Python-Tutorials im Web durchgehen, z.B. <a href="https://docs.python.org/3/tutorial/index.html" class="external-link">das offizielle
Python-Tutorial</a> oder <a href="https://www.w3schools.com/python/" class="external-link">das
Python-Tutorial von W3Schools</a>.</p>
<p>In diesem Modul ist besonders die Verarbeitung tabellarischer
Datensätze relevant. Dafür sind die eingebauten Datenstrukturen von
Python nicht optimal geeignet. Daher verwenden wir das Paket <strong><a href="https://pandas.pydata.org" class="external-link">pandas</a></strong>, das speziell für
die Verarbeitung von tabellarischen Daten entwickelt wurde. Für die
Aufgaben in diesem Modul ist es also nötig, zunächst dieses Paket zu
installieren (sofern auf Ihrem Gerät noch nicht geschehen) und dann im
Python-Skript einzubinden. Die Installation erfolgt in der Regel über
den Paketmanager <code>pip</code> in der Kommandozeile oder im Terminal
mit dem Befehl <code>pip install pandas</code>.</p>
<p>Die Einbindung in ein Python-Skript erfolgt dann üblicherweise mit
dem Befehl:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>ModuleNotFoundError: No module named 'pandas'</code></pre>
</div>
<p>Eine Tabelle in pandas wird über Dataframes (Datentyp
<code>DataFrame</code>) repräsentiert. Ein Dataframe ist eine
zweidimensionale Datenstruktur, die Daten in Zeilen und Spalten
organisiert. Jede Spalte eines Dataframe ist ein
<code>Series</code>-Objekt, das eine Liste von Werten enthält. Ein
Dataframe kann als eine Sammlung von <code>Series</code>-Objekten
betrachtet werden, die alle den gleichen Index haben. Mit Index ist die
nullbasierte Zeilennummer oder ein benutzerdefinierter Index gemeint,
der die Zeilen des Dataframe identifiziert.</p>
<p>In einem Dataframe entspricht jede Zeile einem Datensatz (oder einer
Beobachtung) und jede Spalte einer Variable (oder einem Merkmal) dieses
Datensatzes. Damit haben alle Daten in der gleichen Spalte den gleichen
Datentyp, z.B. Ganzzahl (<code>int</code>), Kommazahl
(<code>float</code>), Text/String (<code>str</code>), Datum
(<code>date</code>), usw.</p>
<p>Im Folgenden wird der <a href="https://dplyr.tidyverse.org/reference/storms.html" class="external-link">Beispieldatensatz
<code>storms</code></a> als Dataframe ausgegeben (wie der Datensatz
importiert wird, wird später behandelt). Dieser Datensatz enthält
Messdaten zu tropischen Stürmen an unterschiedlichen Tagen. Hier ist ein
Ausschnitt des Dataframes:</p>
<pre><code>         name  year  month  day  hour   lat  long               status  \
0         Amy  1975      6   27     0  27.5 -79.0  tropical depression
1         Amy  1975      6   27     6  28.5 -79.0  tropical depression
2         Amy  1975      6   27    12  29.5 -79.0  tropical depression
3         Amy  1975      6   27    18  30.5 -79.0  tropical depression
4         Amy  1975      6   28     0  31.5 -78.8  tropical depression
...       ...   ...    ...  ...   ...   ...   ...                  ...
19532  Nicole  2022     11   10    19  29.2 -83.0       tropical storm
19533  Nicole  2022     11   11     0  30.1 -84.0       tropical storm
19534  Nicole  2022     11   11     6  31.2 -84.6  tropical depression
19535  Nicole  2022     11   11    12  33.2 -84.6  tropical depression
19536  Nicole  2022     11   11    18  35.4 -83.8            other low

       category  wind  pressure  tropicalstorm_force_diameter  \
0           NaN    25      1013                           NaN
1           NaN    25      1013                           NaN
2           NaN    25      1013                           NaN
3           NaN    25      1013                           NaN
4           NaN    25      1012                           NaN
...         ...   ...       ...                           ...
19532       NaN    40       989                         300.0
19533       NaN    35       992                         300.0
19534       NaN    30       996                           0.0
19535       NaN    25       999                           0.0
19536       NaN    25      1000                           0.0

       hurricane_force_diameter
0                           NaN
1                           NaN
2                           NaN
3                           NaN
4                           NaN
...                         ...
19532                       0.0
19533                       0.0
19534                       0.0
19535                       0.0
19536                       0.0

[19537 rows x 13 columns]</code></pre>
<p>Hinweis: bei der Ausgabe eines Dataframe mit der Funktion
<code>print()</code> werden standardmäßig jeweils die ersten und letzten
fünf Zeilen ausgegeben. Da dieser Datensatz 13 Spalten hat und daher
nicht alle Spalten in einer Reihe dargestellt werden können, wird die
Breite des Dataframe in drei Teile aufgeteilt und separat
dargestellt.</p>
<p>Dataframes können sowohl aus Dateien und dem Web importiert werden
(s. nächstes Kapitel) oder aber aus anderen Datenstrukturen erstellt
werden, z.B. aus Dictionarys (<code>dict</code>) und Listen
(<code>list</code>). Hier ist ein Beispiel, das einen Dataframe erzeugt
mittels eines Dictionarys, dessen Schlüssel den Spaltennamen des
Dataframes entsprechen, und dessen Werte jeweils Listen für die Inhalte
(Zeilen) der entsprechenden der Spalten enthalten:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>marriages <span class="op">=</span> pd.DataFrame({</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    <span class="st">"name"</span>: [<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Charlie"</span>],</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="st">"age"</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>],</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="st">"married"</span>: [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>})</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'pd' is not defined</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">print</span>(marriages)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'marriages' is not defined</code></pre>
</div>
<p>Ziel der Datenverarbeitung ist es, vorliegende Datensätze so zu
transformieren, dass sie für die Analyse und Visualisierung geeignet
sind und ein Format wie im obigen Beispiel vorweisen. Wenn das der Fall
ist, sprich</p>
<ul>
<li>jede Zeile entspricht einem Datensatz und</li>
<li>jede Spalte entspricht einer Variable,</li>
</ul>
<p>wird der Datensatz als “tidy” bezeichnet. Im folgenden Bild ist das
dies veranschaulicht:</p>
<figure><img src="https://raw.githubusercontent.com/hadley/r4ds/main/images/tidy-1.png" alt="tidy data concept" width="600" class="figure mx-auto d-block"></figure><div id="spaltenzugriff" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="spaltenzugriff" class="callout-inner">
<h3 class="callout-title">Spaltenzugriff</h3>
<div class="callout-content">
<p>Betrachten sie den Datensatz <code>marriages</code> von oben.</p>
<p><em>Wie können Sie nur die Spalte <code>age</code> aus dem Datensatz
extrahieren?</em></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Antwort
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Es gibt dafür unterschiedliche Möglichkeiten, die im Folgenden
aufgeführt sind:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Extrahiert die Spalte als Liste von Werten (in Pandas der Datentyp Series)</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>marriages[<span class="st">"age"</span>]</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Alternative Schreibweise, die möglich ist, wenn der Spaltenname keine Leerzeichen oder Sonderzeichen enthält</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>marriages.age</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># Pandas erlaubt Zugriff auch über .loc[]</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>marriages.loc[:, <span class="st">"age"</span>]</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># ... und indexbasiert über .iloc[] (hier: 1 steht für die zweite Spalte, da der Index 0-basiert ist)</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>marriages.iloc[:, <span class="dv">1</span>]</span></code></pre>
</div>
<p>Hinweise: - Der Zugriff über den Spaltennamen ist in der Regel die
bevorzugte Methode, da sie am lesbarsten ist. - Der Zugriff über den
Index ist weniger lesbar und sollte nur verwendet werden, wenn der
Spaltenname nicht bekannt ist oder nicht verwendet werden kann. -
<code>loc</code> und <code>iloc</code> sind mächtige Methoden, die ganze
Bereiche von Zeilen und Spalten auswählen können, wie z.B.
<code>marriages.loc[1:2, "age"]</code> liefert Zeilen 1 bis 2 der Spalte
<code>age</code>. Der Unterschied zwischen <code>loc</code> und
<code>iloc</code> ist, dass <code>loc</code> die Zeilen und Spalten über
den Indexnamen adressiert, während <code>iloc</code> dies mit dem
Indexwert macht.</p>
</div>
</div>
</div>
</div>
<div id="datentypen" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="datentypen" class="callout-inner">
<h3 class="callout-title">Datentypen</h3>
<div class="callout-content">
<p><em>Welche Datentypen haben die Spalten des Datensatzes?</em></p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Antwort
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ul>
<li>
<code>name</code>: Text (<code>str</code>)</li>
<li>
<code>age</code>: Ganzzahl (<code>int</code>); wenn man Kommazahlen
angibt, wird der Datentyp <code>float</code> sein (z.B.
<code>25.0</code>)</li>
<li>
<code>married</code>: Wahrheitswert (<code>bool</code>) mit
<code>True</code> für verheiratet und <code>False</code> für nicht
verheiratet</li>
</ul>
</div>
</div>
</div>
</div>
<div id="aufbau" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="aufbau" class="callout-inner">
<h3 class="callout-title">Aufbau</h3>
<div class="callout-content">
<p><em>Wieviele Beobachtungen und Variablen hat der Datensatz?</em></p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Antwort
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ul>
<li>Beobachtungen: <strong>4</strong> = Anzahl der Zeilen bzw. Länge der
Spalten</li>
<li>Variablen: <strong>3</strong> = Anzahl der Spalten</li>
</ul>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Spalten in einem <code>DataFrame</code> werden auch Variablen (des
Datensatzes) genannt.
<ul>
<li>Eine Spalte ist eine <code>Series</code>, also eine Liste von Werten
des gleichen Datentyps.</li>
</ul>
</li>
<li>Zeilen in einem <code>DataFrame</code> werden auch Beobachtungen
(des Datensatzes) genannt.</li>
<li>Ein Datensatz ist “tidy”,
<ul>
<li>wenn jede Zeile einem Datensatz und jede Spalte einer Variable
entspricht.</li>
<li>Vereinfacht: wenn man beim Visualisieren der Daten nur jeweils eine
Zeile pro Datenpunkt benötigt und keine doppelt verwendet wird.</li>
</ul>
</li>
</ul>
</div>
</div>
</div></section><section id="aio-Datenimport"><p>Content from <a href="Datenimport.html">Datenimport aus Dateien</a></p>
<hr>
<p>Last updated on 2024-10-08 |

        <a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/edit/main/episodes/Datenimport.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Wie importiere ich Daten?</li>
<li>Auf was muss ich achten?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Datenimport via <code>pandas</code>
</li>
<li>Kodierung von Zahlen und Texten</li>
<li>Pfadangaben</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Mit Python können Daten aus verschiedenen Quellen und von
verschiedenen Orten eingelesen werden.</p>
<p>Die gängigsten Quellen sind:</p>
<ul>
<li>Textdateien (z.B. <code>.csv</code>, <code>.tsv</code>,
<code>.txt</code>)</li>
<li>Excel-Dateien (z.B. <code>.xlsx</code>, <code>.xls</code>)</li>
<li>Datenbanken (z.B. MySQL, PostgreSQL, SQLite)</li>
</ul>
<p>Die gängigsten Orte sind:</p>
<ul>
<li>lokale Dateien</li>
<li>URLs, also direkter Datenimport aus dem Internet oder lokalem
Netzwerk</li>
</ul>
<p>Im Folgenden einige Beispiele zum Einlesen von Daten aus Dateien in
Python. Die lokalen Dateien müssen sich im <em>Arbeitsverzeichnis</em>
befinden, also in dem gleichen Verzeichnis in dem das Python-Skript
ausgeführt wird, oder über den relativen bzw. absoluten Dateipfad
adressiert werden (siehe weiter unten). Um den folgenden Beispielcode
mit lokalen Dateien auszuführen, müssen daher die Dateien <a href="../data/storms-2019-2021.csv">storms-2019-2021.csv</a> und <a href="../data/storms-2019-2021.xlsx">storms-2019-2021.xlsx</a> erst
heruntergeladen und ins aktuelle Arbeitsverzeichnis kopiert werden.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># zunächst importieren wir das Paket pandas und benennen es um in "pd", das ist gängige Praxis und findet sich in fast allen Beispielen so wieder</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># CSV-Datei aus dem Internet laden und in die Variable web_data speichern</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>web_data <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/tidyverse/dplyr/master/data-raw/storms.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># Geben wir die Daten aus</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="bu">print</span>(web_data)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Lokale Excel-Datei laden mit expliziter Angabe des Tabellenblatts</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>excel_data <span class="op">=</span> pd.read_excel(<span class="st">"storms-2019-2021.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">"storms-2020"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="bu">print</span>(excel_data)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co"># Lokale CSV-Datei laden. Achtung: die oben aus dem Internet geladene Datei verwendet gemäß CSV-Standard ein Komma als Trennzeichen, die lokale Datei jedoch ein Semikolon. Die Zahlen in dieser CSV-Datei sind auch mit westeuropäischem Zahlenformat ("," als Dezimaltrennzeichen und "." als Tausendertrennzeichen) gespeichert. Daher müssen hier beim Laden die Parameter sep, decimal und thousands angepasst werden. Auch das Encoding der Datei kann angegeben werden, vor allem wenn es nicht UTF-8 ist.</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>csv_data <span class="op">=</span> pd.read_csv(<span class="st">"storms-2019-2021.csv"</span>, sep<span class="op">=</span><span class="st">";"</span>, decimal<span class="op">=</span><span class="st">","</span>, thousands<span class="op">=</span><span class="st">"."</span>, encoding<span class="op">=</span><span class="st">"UTF-8"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="bu">print</span>(csv_data)</span></code></pre>
</div>
<p>Beachten sie im letzten Beispiel das explizite Setzen des
Textencodings, um sicherzustellen, dass Umlaute korrekt eingelesen
werden (hier im Beispiel wird <code>latin1</code> verwendet, was für
westeuropäische Länder wie Deutschland oder Frankreich üblich ist bzw.
war). Dies ist vor allem beim <em>Import von alten Daten</em> wichtig,
die in einem anderen Zeichensatz kodiert sein könnten. Heutzutage wird
meist <code>UTF-8</code> verwendet, was ein internationaler Standard ist
und alle Zeichen korrekt darstellt. Dies ist auch das Standardencoding
für die meisten Funktionen wie z.B. <code>read_csv</code>.</p>
<p>Im dem Beispiel zu <code>read_csv</code> werden auch das
Dezimaltrennzeichen und das Tausendertrennzeichen explizit angegeben, da
z.B. westeuropäische Länder wie Deutschland oder Frankreich diese
Trennzeichen vertauscht haben im Vergleich zu englischsprachigen Ländern
(welche die Standardspezifikationen für CSV-Dateien sind).</p>
<p>Es gibt noch viele weitere nützliche optionale Parameter der
Funktionen <code>read_csv()</code> die in der <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html" class="external-link">Dokumentation</a>
dieser Funktion beschrieben sind, wie beispielweise die einzulesenden
Zeilen limitieren, Startzeile festlegen, usw.</p>
<p>Das Speichern der Daten in einer Datei erfolgt analog, indem einfach
<code>to_</code> anstelle von <code>read_</code> verwendet wird, also
z.B. <code>to_csv()</code>. Bei <code>to_csv()</code> können analog die
Spaltentrennzeichen usw. angegeben werden. Da in einem DataFrame jede
Zeile einen Index hat, wird dieser standardmäßig auch in die Datei
geschrieben. In der Regel möchten wir das nicht, so können wir den
Parameter <code>index=False</code> setzen, z.B. mit
<code>csv_data.to_csv("output.csv", index=False)</code>.</p>
<p>Die Funktionen für das Einlesen und Speichern von Daten mit dem
<code>pandas</code> Paket sind in der <a href="https://pandas.pydata.org/docs/user_guide/io.html" class="external-link">Pandas-Dokumentation
zu IO-Tools</a> zusammengefasst.</p>
<div id="frage-zu-csv-import" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="frage-zu-csv-import" class="callout-inner">
<h3 class="callout-title">Frage zu CSV Import</h3>
<div class="callout-content">
<p><em>Was sind bei <code>read_csv()</code> die Standardwerte für
<code>sep</code> (Spaltentrennzeichen), <code>decimal</code>
(Dezimaltrennzeichen), <code>thousands</code> (Tausendertrennzeichen)
und <code>encoding</code> (Zeichenkodierung), wenn sie nicht explizit
beim Aufruf der Funktion angegeben werden?</em></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Antwort
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Die Standardwerte sind: Komma für Spaltentrennzeichen, Punkt für
Dezimaltrennzeichen, kein Tausendertrennzeichen, und UTF-8 für die
Zeichenkodierung. Die Parameter müssen nur angegeben werden, wenn die
CSV-Datei von diesen Standardwerten abweicht.</p>
</div>
</div>
</div>
</div>
<div id="aufgabe-datenimport" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="aufgabe-datenimport" class="callout-inner">
<h3 class="callout-title">Aufgabe: Datenimport</h3>
<div class="callout-content">
<p>Führen sie die obigen Beispiele aus und passen sie sie an, um die
Dateien <code>storms-2019-2021.csv</code> und
<code>storms-2019-2021.xlsx</code> einzulesen. Hierzu müssen diese
Dateien ggf. zuvor heruntergeladen werden (oder sie verwenden direkt die
URL zu den online verfügbaren Dateien).</p>
<p><em>Wieviele Zeilen haben die jeweiligen Datensätze? Und wie erklärt
sich der Unterschied?</em></p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Antwort
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Die Datensätze haben unterschiedliche Größen:</p>
<ul>
<li>
<code>storms-2019-2021.csv</code> hat 19 Zeilen, es umfasst die
Jahre 2019-2021.</li>
<li>
<code>storms-2019-2021.xlsx</code> hat 10 Zeilen, es umfasst nur das
Jahr 2020 da nur ein einzelnes Datenblatt importiert wurde.</li>
</ul>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="pfade-und-arbeitsverzeichnis">Pfade und Arbeitsverzeichnis<a class="anchor" aria-label="anchor" href="#pfade-und-arbeitsverzeichnis"></a>
</h2>
<hr class="half-width">
<p>Dateien können auch <em>relativ</em> zum Arbeitsverzeichnis geladen
werden. Das Arbeitsverzeichnis ist der Ordner, in dem das aktuelle
Python-Skript ausgeführt wird. Dies erlaubt das Laden von Dateien ohne
Angabe des vollständigen Pfades, auch wenn sich die Dateien nicht im
Arbeitsverzeichnis befinden. Der große Vorteil ist, dass der Code
portabler wird, da er nicht mehr von absoluten Pfaden (also wo die Daten
auf ihrem Computer genau liegen) abhängt.</p>
<p>Zum Beispiel, wenn sich die Datei <code>storms.csv</code> im
Unterordner <code>data</code> des Arbeitsverzeichnisses befindet, kann
sie mit <code>read_csv("data/storms.csv")</code> geladen werden.</p>
<p>Wenn nötig, können auch vollständige Pfade verwendet werden, um
Dateien von beliebigen Orten auf dem Computer zu laden. Das nennt man
dann einen <em>absoluten Pfad</em>. Ein Beispiel auf einem
Windows-System wäre
<code>read_csv("C:/Users/Username/Documents/data.csv")</code>.</p>
<p>Wenn sie die letzte Pfadangabe mit der Standard-Windows-Schreibweise
vergleichen, werden sie feststellen, dass diese normalerweise mit
Backslashes <code>\</code> arbeitet, also hier
<code>"C:\Users\Username\Documents\data.csv"</code>. Das Problem ist,
dass der Backslash in Python als Escape-Zeichen verwendet wird, um
spezielle Zeichen (wie z.B. Zeilenumbruch oder Tabulator) zu kodieren.
Daher wird der Backslash in Pfadangaben in R oft verdoppelt, um dies zu
umgehen. Also würde der Pfad in R so aussehen:
<code>"C:\\Users\\Username\\Documents\\data.csv"</code>. Alternativ
können sie auch in Windows (wie im obigen Beispiel) die
“Linux-Schreibweise” verwenden, die mit Schrägstrichen <code>/</code>
arbeitet, die in R ohne Probleme verwendet werden können.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Dateinamen sind Textinformation und müssen in Anführungszeichen
gesetzt werden.</li>
<li>Pfade können absolut oder relativ zum Arbeitsverzeichnis angegeben
werden. Letzteres ist portabler und empfohlen.</li>
<li>Unter Microsoft Windows können Pfade in Pyhton auch mit
Schrägstrichen <code>/</code> statt Backslashes <code>\</code>
geschrieben werden.</li>
<li>Achten sie auf die Angabe der korrekten Kodierung von Textdateien,
um Umlaute und Sonderzeichen korrekt einzulesen.</li>
<li>Denken sie daran, dass deutsche CSV-Dateien oft Semikolon
(<code>;</code>) als Spaltentrennzeichen und Komma <code>,</code> als
Dezimaltrenner verwenden. Auch Excel verwendet für den CSV-Export das
Semikolon als Spaltentrennzeichen.</li>
<li>Excel-Dateien können mehrere Blätter (<em>sheets</em>) enthalten,
die einzeln importiert werden müssen.</li>
<li>Zusammenfassung der Lese- und Schreiboperationen in der <a href="https://pandas.pydata.org/docs/user_guide/io.html" class="external-link">Pandas-Dokumentation
zu IO-Tools</a>.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-Datenverarbeitung"><p>Content from <a href="Datenverarbeitung.html">Datenverarbeitung</a></p>
<hr>
<p>Last updated on 2024-10-08 |

        <a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/edit/main/episodes/Datenverarbeitung.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<p>TODO - Wie baue ich komplexe Workflows mit pipes? - Wie transformiere
ich Tabellen? - Wie bearbeite ich Text? - Wie führe ich mehrere
Datensätze zusammen?</p>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>TODO - Überblick über die Möglichkeiten der Datenverarbeitung mit
<code>tidyverse</code> Paketen</p>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="workflows-mittels-piping">Workflows mittels Piping<a class="anchor" aria-label="anchor" href="#workflows-mittels-piping"></a>
</h2>
<hr class="half-width">
<p>In vielen Datenverarbeitungssprachen ist der Pipe-Operator ein
nützliches Werkzeug, um Arbeitsschritte zu verketten, sodass das
Abspeichern von Zwischenergebnisse in Variablen vermieden werden
kann.</p>
<p>Seit R 4.1.0 ist der Pipe-Operator <code>|&gt;</code> standardmäßig
in R enthalten. Alternativ bietet das <code>magrittr</code> package den
Pipe-Operator <code>%&gt;%</code>, welcher eine etwas umfangreichere
Funktionalität bietet. Wer sich für die Unterschiede interessiert, kann
diese im <a href="https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/" class="external-link">Blogbetrag
dazu</a> nachlesen. Für die meisten Anwendungen ist der
Standard-Pipe-Operator <code>|&gt;</code> ausreichend und äquivalent zu
<code>%&gt;%</code> verwendbar.</p>
<p>Der Pipe-Operator ist ein nützliches Werkzeug, um den Code lesbarer
zu machen und die Arbeitsschritte in einer logischen Reihenfolge zu
verketten. Hierbei wird das Ergebnis des vorherigen Arbeitsschrittes als
erstes Argument des nächsten Arbeitsschrittes verwendet. Da das erste
Argument von (den meisten) Funktionen der Datensatz ist, ermöglicht dies
die Verknüpfung von Arbeitsschritten zu einem Workflow ohne
Zwischenergebnisse speichern zu müssen oder Funktionsaufrufe zu
verschachteln.</p>
<p>Zum Beispiel:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># einfaches Beispiel zur Verarbeitung eines Vektors mit base R Funktionen</span></span>
<span></span>
<span><span class="co"># verschachtelte Funktionsaufrufe</span></span>
<span><span class="co"># entspricht der Leserichtung von rechts nach links</span></span>
<span><span class="co"># und einer Ergebnisbeschreibung ala "Wurzel der Summe ohne NA von 1, 2, 3, NA"</span></span>
<span><span class="fu">sqrt</span><span class="op">(</span> <span class="fu">sum</span><span class="op">(</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># mit Pipe-Operator</span></span>
<span><span class="co"># entspricht der Leserichtung von links nach rechts</span></span>
<span><span class="co"># und einer Beschreibung der Arbeitsschritte in ihrer Reihenfolge</span></span>
<span><span class="co"># ala "nehme 1, 2, 3, NA, summiere ohne NA und davon die Wurzel"</span></span>
<span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">sum</span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">sqrt</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ok, hier nicht zwingend nötig, aber zur Veranschlaulichung des Prinzips.. ;)</span></span></code></pre>
</div>
<p>Pipe-basierte workflows sind …</p>
<ul>
<li>intuitiv lesbar, da sie der normalen Leserichtung entsprechen.</li>
<li>einfacher zu schreiben, da die umschließende Klammerung von
Funktionsaufrufen entfällt. Funktionsargumente sind direkt den
jeweiligen Funktionen zuordenbar.</li>
<li>einfach zu erweitern, da neue Arbeitsschritte einfach an das Ende
der Kette angehängt werden können (z.B.
<code>write_csv("bla.csv")</code> oder bestehende Arbeitsschritte
ausgetauscht werden können.</li>
<li>reduzieren oftmals die Anzahl der temporären Variablen, die im
globalen Workspace herumliegen und die Lesbarkeit des Codes
beeinträchtigen.</li>
<li>einfach zu debuggen, da Zwischenergebnisse einfach ausgegeben werden
können (einfach <code>view()</code> oder <code>print()</code> an das
Ende der entsprechenden Zeile anhängen).</li>
<li>einfach wiederzuverwenden, da der gesamte Workflow in einer Zeile
zusammengefasst ist und immer als Block aufgerufen wird. Dadurch können
keine Zwischenschritte vergessen werden und der Workflow ist immer
konsistent.</li>
</ul>
<div id="mehrzeilige-r-kommandos" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="mehrzeilige-r-kommandos" class="callout-inner">
<h3 class="callout-title">Mehrzeilige R Kommandos</h3>
<div class="callout-content">
<p><strong>Wichtig:</strong> R Kommandos können über mehrere Zeilen
verteilt werden, wie im obigen Beispiel zu sehen ist, was die
Übersichtlichkeit des Codes erhöht.</p>
<p>Hierzu wird z.B. der Pipe-Operator <code>|&gt;</code> ans Ende der
Zeile geschrieben und der nächste Arbeitsschritt in der nächsten Zeile
fortgesetzt. Gleiches gilt für jeden Operator (<code>+</code>,
<code>==</code>, <code>&amp;</code>, ..) sowie unvollständige
Funktionsaufrufe, bei denen die Klammerung noch nicht geschlossen ist
(d.h. schließende Klammer wird in der nächsten oder einer späteren Zeile
geschrieben).</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="tabellen-verarbeiten">Tabellen verarbeiten<a class="anchor" aria-label="anchor" href="#tabellen-verarbeiten"></a>
</h2>
<hr class="half-width">
<p>Die Transformation von Daten erfolgt i.d.R. mittels des
<code>dplyr</code> packages.</p>
<p><em>Grundlegend gilt: das erste Argument einer Funktion ist immer der
Datensatz!</em></p>
<p>Innerhalb von <code>dplyr</code> Funktionen können <em>Spaltennamen
ohne Anführungzeichen</em> (quoting) verwendet werden.</p>
<p>Basistransformationen sind:</p>
<ul>
<li>Filtern von Zeilen mit gegebenen Kriterien (formulieren was man
BEHALTEN will!) macht man in eckigen Klammern
<ul>
<li>
<code>storms[storms.year == 2020]</code> = alle Sturmdaten aus dem
Jahr 2020</li>
<li>
<code>storms[(storms.year == 2020) &amp; (storms.month == 6)]</code>
= alle Sturmdaten aus dem Juni 2020. Bitte beachten, dass logisch
verknüpfte Bedingungen in Klammern stehen müssen und die einzelnen
Bedingungen mit <code>&amp;</code> (UND) oder <code>|</code> (ODER)
verknüpft werden.</li>
<li>
<code>storms[~pd.isna(storms.category)]</code> = alle Sturmdaten,
bei denen die Kategorie bekannt ist, wobei <code>~</code> für Negation
steht und <code>pd.isna()</code> kurz für <em>is not available</em>
ist.</li>
</ul>
</li>
<li>Konkrete Zeilenauswahl (via Index oder Anzahl) geht mit der Funktion
<code>.loc[]</code> und der Übergabe eines einzelnen Zeilenindex oder
einer Liste von Zeilenindizes
<ul>
<li>
<code>storms.loc[25]</code> = die Zeile 25</li>
<li>
<code>storms.loc[[1, 3, 5]]</code> = die Zeilen 1, 3 und 5</li>
<li>
<code>storms.head(10)</code> = die 10 ersten Zeilen</li>
<li>
<code>storms.tail(10)</code> = die 10 letzten Zeilen<br>
</li>
<li>
<code>storms[storms.pressure == storms.pressure.max()]</code> = die
Zeile(n) mit dem höchsten Wert in der Spalte <code>pressure</code>
</li>
</ul>
</li>
<li>Sortieren von Zeilen
<ul>
<li>
<code>storms.sort_values("year")</code> = Sturmdaten nach Jahr
aufsteigend sortieren</li>
<li>
<code>storms.sort_values("year", ascending=False)</code> =
Sturmdaten nach Jahr absteigend sortieren</li>
<li>
<code>storms.sort_values(["year", "month"], ascending=[True, False])</code>
= Sturmdaten aufsteigend nach Jahr sortieren und innerhalb eines Jahres
absteigend nach Monat</li>
</ul>
</li>
<li>Duplikate entfernen
<ul>
<li>
<code>storms.drop_duplicates()</code> = alle Zeilen mit identischen
Werten in allen Spalten entfernen</li>
<li>
<code>storms[["year", "month", "day"]].drop_duplicates()</code> =
alle Zeilen mit gleichen Werten in den Spalten <code>year</code>,
<code>month</code> und <code>day</code> entfernen (reduziert die Spalten
auf die Ausgewählten)</li>
<li>
<code>storms.drop_duplicates(["year", "month", "day"])</code> = alle
Zeilen mit gleichen Werten in den Spalten <code>year</code>,
<code>month</code> und <code>day</code> entfernen, aber <em>alle Spalten
behalten</em>
</li>
</ul>
</li>
<li>Auswählen/Entfernen von Spalten
<ul>
<li>
<code>storms[["year", "month", "day"]]</code> = nur Spalten mit
Zeitinformation und Namen der Stürme behalten</li>
<li>
<code>storms.drop(columns=["year", "month", "day"])</code> = alle
Datumsspalten entfernen</li>
</ul>
</li>
<li>Umbenennen von Spalten
<ul>
<li>
<code>storms.rename(columns={"name": "sturmname"})</code> = Spalte
<code>name</code> in <code>sturmname</code> umbenennen</li>
</ul>
</li>
<li>Zusammenfassen von Daten: nur eine Zeile mit aggregierten
Informationen (z.B. Mittelwert, Summe, Anzahl, etc.) pro Gruppe
<ul>
<li>
<code>storms.agg({"wind": "max", "name": "count"})</code> = maximale
(<code>max</code>) Windgeschwindigkeit und Anzahl (<code>count</code>)
der Datensätze (Zeilen); auch Durchschnitt (<code>avg</code>), Summe
(<code>sum</code>) und Minimum (<code>min</code>) sind möglich</li>
</ul>
</li>
<li>Gruppierung von Daten = “Zerlegung” des Datensatzes in Teiltabellen,
für die anschliessende Arbeitsschritte unabängig voneinander
durchgeführt werden. Wird i.d.R. verwendet, wenn die Aufgabe “pro …”
oder “für jede …” lautet.
<ul>
<li>
<code>storms.groupby("year")</code> = Gruppierung der Sturmdaten
nach Jahr (aber noch keine Aggregation!); das ist nur ein
Zwischenschritt, der die unterschiedlichen Werte der Jahre ermittelt und
für die folgenden Arbeitsschritte bereitstellt</li>
<li>
<code>storms.groupby("year").agg({"wind": "max", "name": "count"})</code>
= maximale Windgeschwindigkeit und Anzahl der Datenzeilen <em>pro
Jahr</em>
</li>
<li>
<code>storms[storms['wind'] == storms.groupby('year')['wind'].transform('max')]</code>
= alle Sturmdaten, bei denen die maximale Windgeschwindigkeit des
jeweiligen erreicht wurde (keine Zusammenfassung!). `transform</li>
<li>Grouping ist ein extrem mächtiges Werkzeug, das in vielen
Situationen verwendet wird, um Daten zu transformieren. Allerdings
braucht es etwas Übung, um zu verstehen, wie es funktioniert.</li>
</ul>
</li>
<li>Spalten hinzufügen/ausrechnen oder bestehende Spalten verändern
(z.B. Einheiten umrechnen)
<ul>
<li>
<code>storms["wind_kmh"] = storms.wind * 1.852</code> =
Windgeschwindigkeit in Knoten nach km/h konvertieren und als <em>neue
Spalte hinzufügen</em> (hier darf für die Benennung der neuen Spalte
nicht die Punktnotation verwendet werden)</li>
<li>
<code>storms.wind = storms.wind * 1.852</code> = Windgeschwindigkeit
in Knoten nach km/h konvertieren und <em>bestehende Spalte
überschreiben</em>
</li>
</ul>
</li>
<li>Spalten entfernen
<ul>
<li>
<code>storms.pop("wind_kmh")</code> = die Spalte
<code>wind_kmh</code> entfernen; als Ergebnis wird die Spalte
zurückgegeben, mit der dann weitere Operationen außerhalb des DataFrame
durchgeführt werden können, wie z.B. hier:</li>
<li>
<code>storms.insert(2, "wind_kmh", storms.pop("wind_kmh"))</code> =
die Spalte <code>wind_kmh</code> an die dritte Stelle (nullbasierter
Index ist 2) verschieben durch Entfernen mit <code>pop()</code> und
Wiedereinfügen mit <code>insert</code> an der gewünschten Stelle mit dem
gleichen Namen <code>wind_kmh</code>
</li>
</ul>
</li>
</ul>
<div id="stürme-vor-1980" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="stürme-vor-1980" class="callout-inner">
<h3 class="callout-title">Stürme vor 1980</h3>
<div class="callout-content">
<p><em>Erstelle eine Tabelle, welche für jeden Sturm vor 1980 neben
dessen Namen nur das Jahr und dessen Status beinhaltet und nach Jahr und
Status sortiert ist.</em></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Hinweise
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Gehen Sie wie folgt vor: - Reduzieren Sie auf jene Zeilen, in denen
das Jahr kleiner als 1980 ist - Reduzieren Sie auf die Spalten
<code>name</code>, <code>year</code> und <code>status</code> - Durch die
Spaltenreduktion sind Duplikate entstanden, entfernen Sie diese -
Sortieren Sie nach Jahr und Status</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Lösung
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Eine Lösung mit Zwischenschritten, bei denen die Arbeitsschritte
einzeln ausgeführt und jeweils in der Tabelle <code>ergebnis</code>
gespeichert werden, könnte so aussehen:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Filtern nach Stürmen vor 1980</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>ergebnis <span class="op">=</span> storms[storms[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">1980</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'storms' is not defined</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Reduzieren auf die Spalten name, year und status</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ergebnis <span class="op">=</span> ergebnis[[<span class="st">'name'</span>, <span class="st">'year'</span>, <span class="st">'status'</span>]]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'ergebnis' is not defined</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Entfernen von Duplikaten</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>ergebnis <span class="op">=</span> ergebnis.drop_duplicates()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'ergebnis' is not defined</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Sortieren nach Jahr und Status</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>ergebnis <span class="op">=</span> ergebnis.sort_values(by<span class="op">=</span>[<span class="st">'year'</span>, <span class="st">'status'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'ergebnis' is not defined</code></pre>
</div>
<p>Eine Lösung, die alle Arbeitsschritte in einer Zeile zusammenfasst,
könnte so aussehen:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ergebnis <span class="op">=</span> storms[storms[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">1980</span>][[<span class="st">'name'</span>, <span class="st">'year'</span>, <span class="st">'status'</span>]].drop_duplicates().sort_values(by<span class="op">=</span>[<span class="st">'year'</span>, <span class="st">'status'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'storms' is not defined</code></pre>
</div>
<p>Diese Lösung ist durch die Verkettung der Arbeitsschritte in einer
Zeile kürzer und kompakter, aber auch schwerer zu lesen. Um das
übersuchtlich zu halten, kann man die Arbeitsschritte auch in mehreren
Zeilen schreiben. In Python setzt man dazu entweder den mehrzeilige
Befehl in eine umgreifende Klammer wie hier:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>(storms</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  [storms[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">1980</span>]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  [[<span class="st">'name'</span>, <span class="st">'year'</span>, <span class="st">'status'</span>]]</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  .drop_duplicates()</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  .sort_values(by<span class="op">=</span>[<span class="st">'year'</span>, <span class="st">'status'</span>]))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'storms' is not defined</code></pre>
</div>
<p>… oder aber terminiert jede Zeile mit einem Backslash:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>storms <span class="op">\</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  [storms[<span class="st">'year'</span>] <span class="op">&lt;</span> <span class="dv">1980</span>] <span class="op">\</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  [[<span class="st">'name'</span>, <span class="st">'year'</span>, <span class="st">'status'</span>]] <span class="op">\</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  .drop_duplicates() <span class="op">\</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  .sort_values(by<span class="op">=</span>[<span class="st">'year'</span>, <span class="st">'status'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError: name 'storms' is not defined</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="gruppieren-und-aggregieren">Gruppieren und Aggregieren<a class="anchor" aria-label="anchor" href="#gruppieren-und-aggregieren"></a>
</h2>
<hr class="half-width">
<p>Eine der wichtigsten Funktionen in <code>dplyr</code> ist das
Gruppieren von Daten und das Aggregieren von Werten innerhalb dieser
Gruppen. Dies wird in der Regel mit den Funktionen
<code>group_by()</code> und <code>summarize()</code> durchgeführt.</p>
<p><code>group_by()</code> teilt den Datensatz in Gruppen (imaginäre
Teiltabellen) auf, basierend auf den Werten in einer oder mehreren
Spalten. Im Anschluß wird, vereinfacht gesagt, für jede Gruppe eine
separate Berechnung durchgeführt.</p>
<p>Die Funktion <code>summarize()</code> ist die am häufigsten
verwendete Funktion, um Werte innerhalb dieser Gruppen zu
aggregieren.</p>
<p>Ein einfaches Beispiel:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">storms</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Tabelle nach Jahr gruppieren</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># maximale Windgeschwindigkeit pro Jahr berechnen</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>max_wind <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">wind</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in summarize(group_by(storms, year), max_wind = max(wind)): could not find function "summarize"</code></pre>
</div>
<p>In diesem Beispiel wird die Tabelle <code>storms</code> nach dem Jahr
gruppiert und für jede Gruppe (d.h. jedes Jahr) die maximale
Windgeschwindigkeit berechnet. Das Ergebnis ist eine Tabelle mit zwei
Spalten: <code>year</code> und <code>max_wind</code>.</p>
<div id="achtung" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="achtung" class="callout-inner">
<h3 class="callout-title">Achtung</h3>
<div class="callout-content">
<p>Zu beachten ist, dass Gruppierungen in <code>dplyr</code> nur
virtuell sind und nicht zu einer physischen Aufteilung des Datensatzes
führen. Allerdings wird diese Gruppierung aufrecht erhalten, bis sie
explizit aufgehoben wird (z.B. durch <code>ungroup()</code>) oder dies
implizit durch eine andere Funktion geschieht (z.B. “schließt”
<code>summarize()</code> die letzte Gruppierung).</p>
</div>
</div>
</div>
<div id="gruppiertes-filtern" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="gruppiertes-filtern" class="callout-inner">
<h3 class="callout-title">Gruppiertes Filtern</h3>
<div class="callout-content">
<p><em>Erstelle eine Tabelle, welche für jeden Sturmstatus das Jahr und
den Namen des letzten Sturms auflistet.</em></p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Erwartete Ausgabe
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in select(ungroup(filter(mutate(group_by(storms, status), date = parse_date_time(str_c(year, : could not find function "select"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Hinweise
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<ul>
<li>Gruppieren sie die Tabellendaten nach <code>status</code>, um für
jeden Sturmtyp eine “Teiltabelle” zu erhalten</li>
<li>Um den letzten Sturm zu finden
<ul>
<li>Möglichkeit 1: neue Spalte mit Zeitinformation zusammensetzen und
damit die Zeile mit maximalen Datum (pro Teiltabelle) extrahieren</li>
<li>Möglichkeit 2: Teiltabellen bzgl. Zeitspalten sortieren und erste
bzw. letzte Zeile extrahieren</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Lösungen
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="section level3">
<h3 id="alternative-1">Alternative 1<a class="anchor" aria-label="anchor" href="#alternative-1"></a>
</h3>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">storms</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># decompose table by storm status</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">status</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># encode time information of each entry in a single column</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">parse_date_time</span><span class="op">(</span><span class="fu">str_c</span><span class="op">(</span><span class="va">year</span>,<span class="va">month</span>,<span class="va">day</span>,<span class="va">hour</span>,sep<span class="op">=</span><span class="st">"-"</span><span class="op">)</span>, <span class="st">"%Y-%m-%d-%H"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># filter for the latest date</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="fu">max</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="co"># ALTERNATIVELY cut out row with latest date</span></span>
<span>  <span class="co"># slice_max(date, n=1) |&gt;</span></span>
<span>  </span>
<span>  <span class="co"># rejoin table information and undo grouping</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">status</span>, <span class="va">year</span>, <span class="va">name</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="alternative-2">Alternative 2<a class="anchor" aria-label="anchor" href="#alternative-2"></a>
</h3>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">storms</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># decompose table by storm status</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">status</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># sort ascending by date (hierarchical sorting)</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">year</span>,<span class="va">month</span>,<span class="va">day</span>,<span class="va">hour</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># pick last row w.r.t. sorting</span></span>
<span>  <span class="fu">slice_tail</span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="co"># ALTERNATIVELY pick row with last index</span></span>
<span>  <span class="co"># slice( n() ) |&gt; </span></span>
<span>  </span>
<span><span class="co"># OR do both (sort+pick) directly with slice_max</span></span>
<span>  <span class="co"># slice_max( tibble(year,month,day,hour), n=1, with_ties = F ) |&gt; </span></span>
<span>  </span>
<span>  <span class="co"># rejoin table information and undo grouping</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">status</span>, <span class="va">year</span>, <span class="va">name</span><span class="op">)</span> </span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Eine Zusammenfassung der wichtigsten Funktionen in <code>dplyr</code>
finden sich in dessen Cheat Sheet.</p>
<p><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf" class="external-link"><img src="https://raw.githubusercontent.com/rstudio/cheatsheets/main/pngs/thumbnails/data-transformation-cheatsheet-thumbs.png" style="width:100.0%" alt="CLICK TO ENLARGE: cheat sheet for dplyr ackage" class="figure"></a></p>
</section><section><h2 class="section-heading" id="tabellengestalt-ändern">Tabellengestalt ändern<a class="anchor" aria-label="anchor" href="#tabellengestalt-%C3%A4ndern"></a>
</h2>
<hr class="half-width">
<p>Die “tidy” Form ist eine spezielle Form von tabellarischen Daten, die
für viele Datenverarbeitungsschritte geeignet ist. In der “tidy” Form
sind die Daten so organisiert, dass jede Beobachtung (z.B. Messung) in
einer Zeile notiert ist und jede Variable (also z.B. Beschreibungungen
und Messwerte) eine Spalte definieren. Diese Art der Tabellenform wird
auch “long table” oder “schmal” genannt, weil die Daten in einer langen,
schmalen Tabelle organisiert sind.</p>
<p>Allerdings werden Rohdaten häufig in einer “ungünstigen” Form
vorliegen, die für die weitere Verarbeitung nicht optimal ist. Manuelle
Datenerfassung erfolgt oft in grafischen Oberflächen wie MS Excel, worin
die Daten i.d.R. in einer “breiten” oder “wide table” Form gespeichert,
in der eine Variable (z.B. Messwert) in mehreren Spalten gespeichert
ist. In der “breiten” Form sind die Daten so organisiert, dass
Beobachtungen (und ihre Messwerte) in Spalten gruppiert sind, während
die Variablen in den Zeilen stehen.</p>
<p>Hier ein Beispiel aus dem Tutorial <a href="https://tavareshugo.github.io/r-intro-tidyverse-gapminder/" class="external-link">Introduction
to R/tidyverse for Exploratory Data Analysis</a></p>
<figure><img src="https://github.com/tavareshugo/r-intro-tidyverse-gapminder/blob/e08446803314d9c8d59f309e3dee7b1cdd9a3158/fig/07-tidyr_pivot.png?raw=true" alt="wide and long table examples and respective pivoting calls" width="500" class="figure mx-auto d-block"></figure><p>Das obige Beispiel zeigt eine “breite” Tabelle (rechts) und eine
“lange” Tabelle (links) mit den gleichen Daten. Die Transformation
zwischen beiden Formaten kann durch die Funktionen
<code>pivot_longer()</code> und <code>pivot_wider()</code> erreicht
werden. Beachten sie im Beispiel, dass die Spaltennamen des wide table
Formats in beide Transformationsrichtungen verarbeitet werden
können.</p>
<div id="vor--und-nachteile" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="vor--und-nachteile" class="callout-inner">
<h3 class="callout-title">Vor- und Nachteile</h3>
<div class="callout-content">
<p>Während das wide table Format kompakter und damit ggf. besser zur
Datenerfassung und -übersicht geeignet ist, ist das long table Format
besser für die Datenanalyse und -visualisierung geeignet. In letzterem
liegt Information redundant vor, da in jeder Zeile die komplette
Information einer Beobachtung vorliegen muss.</p>
</div>
</div>
</div>
<p>Die tidyverse Bibliothek <code>tidyr</code> bietet Funktionen, um
Daten zwischen diesen beiden Formen zu transformieren. Dies wird auch
als “reshaping” oder “pivotieren” bezeichnet. Hiermit können Spalten in
Zeilen und umgekehrt umgeformt werden.</p>
<p>Das Beispiel hierfür ist etwas länger, um für Anschauungszwecke die
Datentabelle erst etwas einzukürzen.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">storms</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Arthur"</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># speziellen Sturm auswählen</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">name</span>, <span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, <span class="va">wind</span>, <span class="va">pressure</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># (zur Vereinfachung) nur spezifische Spalten</span></span>
<span>  <span class="co"># Verteile Wind und Druck in separate Zeilen mit entsprechenden Labels in einer neuen Spalte "measure"</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">wind</span>, <span class="va">pressure</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"measure"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">slice_head</span><span class="op">(</span>n<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="co"># nur die ersten 4 Zeilen anzeigen</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in slice_head(pivot_longer(select(filter(storms, name == "Arthur" &amp; : could not find function "slice_head"</code></pre>
</div>
<p>Details und weitere Funktionen und Beispiele sind im Cheat Sheets des
<code>tidyr</code> Paketes übersichtlich zusammengefasst.</p>
<p><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/tidyr.pdf" class="external-link"><img src="https://raw.githubusercontent.com/rstudio/cheatsheets/master/pngs/thumbnails/tidyr-thumbs.png" style="width:100.0%" alt="CLICK TO ENLARGE: cheat sheet for tidyr ackage" class="figure"></a></p>
</section><section><h2 class="section-heading" id="textdaten-verändern-und-verwenden">Textdaten verändern und verwenden<a class="anchor" aria-label="anchor" href="#textdaten-ver%C3%A4ndern-und-verwenden"></a>
</h2>
<hr class="half-width">
<p>Um Textdaten (<em>Strings</em>) zu verändern, gibt es verschiedene
Funktionen des <code>stringr</code> Paketes, die in Kombination mit
<code>mutate()</code> oder anderen Funktionen verwendet werden können.
Die meisten Funktionen des <code>stringr</code> Paketes sind sehr
intuitiv und haben eine ähnliche Syntax wie die Funktionen des
<code>dplyr</code> Paketes. Zudem sind viele mit regulären Ausdrücken
verwendbar, um Textdaten aufgrund von allgemeineren Textmustern zu
erkennen und zu verändern. Alle Funktionen des <code>stringr</code>
Paketes beginnen mit <code>str_</code> und sind in der <a href="https://stringr.tidyverse.org/reference/index.html" class="external-link">Dokumentation</a>
aufgeführt. Einige wichtige sind:</p>
<ul>
<li>
<code>str_c()</code>: Verkettet mehrere Strings zu einem, analog to
<code>paste0()</code>
</li>
<li>
<code>str_detect()</code>: Prüft, ob ein String einen bestimmten
Textteil enthält</li>
<li>
<code>str_replace()</code>: Ersetzt einen Teil eines Strings durch
einen anderen</li>
<li>
<code>str_to_lower()</code>/<code>str_to_upper</code>: Wandelt alle
Buchstaben in Klein-/Grossbuchstaben um</li>
<li>
<code>str_sub()</code>: Extrahiert einen Teil eines Strings</li>
<li>
<code>str_trim()</code>: Entfernt Leerzeichen am Anfang und Ende
eines Strings</li>
<li>
<code>str_extract()</code>: Extrahiert einen Teil eines Strings, der
einem bestimmten Muster entspricht</li>
<li>
<code>str_remove()</code>: Entfernt einen Teil eines Strings, der
einem bestimmten Muster entspricht</li>
<li>
<code>str_split()</code>: Teilt einen String an einem bestimmten
Trennzeichen auf</li>
</ul>
<p>Die meisten Funktionen liefern nur einen Treffer oder verändern nur
den ersten Treffer. Daher gibt es von vielen Funktionen Varianten, die
alle Treffer finden und/oder verarbeiten, z.B.
<code>str_detect_all()</code>, <code>str_replace_all()</code>,
<code>str_extract_all()</code>.</p>
<p>Die Funktionen sind im <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/strings.pdf" class="external-link"><code>stringr</code>
Cheat Sheet</a> zusammengefasst.</p>
<p><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/strings.pdf" class="external-link"><img src="https://raw.githubusercontent.com/rstudio/cheatsheets/main/pngs/thumbnails/strings-cheatsheet-thumbs.png" style="width:100.0%" alt="CLICK TO ENLARGE: cheat sheet for stringr ackage" class="figure"></a></p>
<p>Beispiele für deren Verwendung mit <code>mutate()</code> und
Co. sind:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beispiel: Grossbuchstaben in Spalte "name" in Kleinbuchstaben umwandeln</span></span>
<span><span class="co"># (und nur eindeutige Einträge in Spalte "name" anzeigen)</span></span>
<span><span class="fu">mutate</span><span class="op">(</span><span class="va">storms</span>, name <span class="op">=</span> <span class="fu">str_to_lower</span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">distinct</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="co"># Beispiel: Jahrhundert aus Spalte "year" extrahieren</span></span>
<span><span class="fu">mutate</span><span class="op">(</span><span class="va">storms</span>, century <span class="op">=</span> <span class="fu">str_sub</span><span class="op">(</span><span class="va">year</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">distinct</span><span class="op">(</span><span class="va">name</span>, <span class="va">century</span><span class="op">)</span></span>
<span> <span class="co"># oder via regulärem Ausdruck</span></span>
<span><span class="fu">mutate</span><span class="op">(</span><span class="va">storms</span>, century <span class="op">=</span> <span class="fu">str_extract</span><span class="op">(</span><span class="va">year</span>, <span class="st">"^\\d{2}"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">mutate</span><span class="op">(</span><span class="va">storms</span>, century <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">year</span>, <span class="st">"..$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Beispiel: Nur Stürme mit "storm" im Status behalten</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">storms</span>, <span class="fu">str_detect</span><span class="op">(</span><span class="va">status</span>, <span class="st">"storm"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">distinct</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre>
</div>
<p>Beachte:</p>
<ol style="list-style-type: decimal">
<li>wenn die (Daten)Eingabe einer <code>stringr</code> Funktion ein
<em>Vektor</em> ist, wird die Funktion auf jedes Element des Vektors
angewendet und gibt einen Vektor mit den Ergebnissen zurück. (=
<em>vektorisierte Prozessierung</em> = zentrales Verarbeitungsprinzip in
R)</li>
<li>wenn die Eingabe <em>kein</em> String ist (z.B. eine Zahl), wird die
Eingabe in einen String umgewandelt und die Funktion auf den
entstandenen String angewendet. (= <em>automatische Typumwandlung</em>,
sogenanntes <em>coercion</em> in R)</li>
</ol></section><section><h2 class="section-heading" id="reguläre-ausdrücke">Reguläre Ausdrücke<a class="anchor" aria-label="anchor" href="#regul%C3%A4re-ausdr%C3%BCcke"></a>
</h2>
<hr class="half-width">
<p>Für komplexe Textverarbeitung werden oft reguläre Ausdrücke
verwendet. Diese erlauben es, Textmuster zu definieren, die in einem
Text gesucht, ersetzt oder extrahiert werden können.</p>
<p>Für eine Einführung in reguläre Ausdrücke siehe <a href="https://www.regexone.com/" class="external-link">RegexOne Tutorial</a> oder <a href="https://rstudio.github.io/cheatsheets/regex.pdf" class="external-link">RStudio RegEx
Cheat Sheet (pdf)</a>.</p>
<div id="reguläre-ausdrücke-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="reguläre-ausdrücke-1" class="callout-inner">
<h3 class="callout-title">Reguläre Ausdrücke</h3>
<div class="callout-content">
<p>Betrachten sie noch einmal die beiden <code>mutate()</code> Beispiele
von oben, in denen das Jahrhundert aus der Spalte “year” mit Hilfe von
regulären Ausdrücken extrahiert wird.</p>
<p><em>Was genau definieren die beiden regulären Ausdrücke
<code>^\\d{2}</code> und <code>..$</code>?</em></p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Lösung
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<ul>
<li>
<code>^\\d{2}</code> = “die ersten zwei (<code>{2}</code>) Ziffern
(<code>\\d</code>) am Textanfang (<code>^</code>)”
<ul>
<li>hier genutzt um das Jahrhundert mit <code>str_extract()</code> zu
extrahieren</li>
</ul>
</li>
<li>
<code>..$</code> = “die letzten zwei beliebigen Zeichen
(<code>..</code>) am Ende des Textes (<code>$</code>)”
<ul>
<li>hier genutzt um die letzten zwei Zeichen (Jahrzehnt) mit
<code>str_remove()</code> zu entfernen</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="daten-zusammenführen">Daten zusammenführen<a class="anchor" aria-label="anchor" href="#daten-zusammenf%C3%BChren"></a>
</h2>
<hr class="half-width">
<p>Oftmals liegen daten in mehreren Tabellen vor, die zusammengeführt
werden müssen, um die Daten zu analysieren. Zum Beispiel können Daten in
einer Tabelle die Anzahl der Sturmtage pro Jahr enthalten und in einer
anderen Tabelle die Kosten für Sturmschäden pro Jahr.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Datensatz mit Sturmschäden pro Jahr (zufällige Werte) für 2015-2024</span></span>
<span><span class="va">costs</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">tibble</span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2015</span><span class="op">:</span><span class="fl">2024</span>, <span class="co"># Jahresbereich festlegen</span></span>
<span>         costs <span class="op">=</span> <span class="fu">runif</span><span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, <span class="fl">1e6</span>, <span class="fl">1e8</span><span class="op">)</span><span class="op">)</span> <span class="co"># Zufallsdaten gleichverteilt erzeugen</span></span>
<span></span>
<span><span class="co"># Anzahl der Sturmtage pro Jahr</span></span>
<span><span class="va">stormyDays</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">storms</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Datensatz in Einzeljahre aufteilen</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># nur eine Zeile pro Monat/Jahr Kombination (pro Jahr) behalten</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">month</span>, <span class="va">day</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># zählen, wie viele Zeilen pro Jahr noch vorhanden sind</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Beispiel (1): Sturmtaginformation (links) mit Kosteninformation (rechts) ergänzen</span></span>
<span><span class="co"># BEACHTE: für Jahre ohne Eintrag in `costs` wird `NA` eingetragen !</span></span>
<span><span class="fu">left_join</span><span class="op">(</span><span class="va">stormyDays</span>, <span class="va">costs</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># nur die ersten und letzten 3 Zeilen anzeigen</span></span>
<span>  <span class="fu">slice</span><span class="op">(</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Beispiel (2): nur Datensätze für die beides, d.h. Sturmtage als auch Kosten, vorhanden ist</span></span>
<span><span class="fu">inner_join</span><span class="op">(</span><span class="va">stormyDays</span>, <span class="va">costs</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></code></pre>
</div>
<div id="spaltennamen" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="spaltennamen" class="callout-inner">
<h3 class="callout-title">Spaltennamen</h3>
<div class="callout-content">
<p>Studieren sie die <a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">Hilfeseite
der join Funktionen</a> und finden sie heraus, <em>wie sie die
Spaltennamen der beiden Tabellen angeben können</em>, um die Daten zu
verbinden, wenn die gemeinsamen Daten in unterschiedlich benannten
Spalten stehen.</p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Lösung
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<p>Das mapping der Spalten erfolgt über einen <em>benannten Vektor</em>,
d.h. die Spaltennamen der linken Tabelle werden als Elementnamen für die
entsprechenden Spaltennamen der rechten Tabelle verwendet:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stormyDays</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span> Jahr <span class="op">=</span> <span class="va">year</span> <span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Jahresspalte exemplarisch umbenannt</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span> <span class="va">Jahr</span> <span class="op">&gt;=</span> <span class="fl">2013</span> <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># geänderte Sturmtaginformation (links) aus der pipe</span></span>
<span>  <span class="co"># mit Kosteninformation (rechts) aus expliziter Tabelle "costs" ergänzen</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span> <span class="va">costs</span>, </span>
<span>      <span class="co"># Explizites mapping von costs$year auf die "Jahr" Spalte der linken Tabelle</span></span>
<span>      <span class="co"># Beachten sie das quoting der Spaltennamen!</span></span>
<span>             by <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>Jahr <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span>      <span class="co"># Alternativ kann das mapping auch über eine Funktion erfolgen:</span></span>
<span>      <span class="co"># Hier sind keine Anführungszeichen notwendig:</span></span>
<span>      <span class="co">#  by = join_by(Jahr = year)</span></span>
<span>      <span class="op">)</span> </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Speichern sie Daten nur in Variablen zwischen, wenn sie diese Daten
mehrfach benötigen.</li>
<li>Verwenden sie Pipes (<code>|&gt;</code>) um Daten durch eine Reihe
von Transformationen zu leiten.</li>
<li>Versuchen sie die Datenverarbeitung in kleine, leicht verständliche
Schritte zu unterteilen.</li>
<li>Vermeiden sie unnötige Schleifen und Schachtelungen, das meiste
lässt sich mit Grouping, vektorisierten Operationen und Joins kompakter
und eleganter lösen.</li>
<li>Auch explizite Elementzugriffe (z.B. <code>df$col</code>) und
-operationen können i.d.R. effizient durch <code>dplyr</code> Funktionen
ersetzt werden.</li>
<li>Zusammenfassungen der Pakete:
<ul>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf" class="external-link"><code>dplry</code>
Cheat Sheet</a></li>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/tidyr.pdf" class="external-link"><code>tidyr</code>
Cheat Sheet</a></li>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/strings.pdf" class="external-link"><code>stringr</code>
Cheat Sheet</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-Visualisierung"><p>Content from <a href="Visualisierung.html">Visualisierung</a></p>
<hr>
<p>Last updated on 2024-10-08 |

        <a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/edit/main/episodes/Visualisierung.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Wie visualisiere ich Daten?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Datenvisualisierung mit <code>ggplot2</code>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Die Visualisierung von Daten ist ein wichtiger Bestandteil der
Datenanalyse, da sie es ermöglicht, Muster und Zusammenhänge in den
Daten zu erkennen und zu kommunizieren. In R wird die Visualisierung von
Daten mit dem <code>ggplot2</code> Paket durchgeführt, das auf der <a href="https://r4ds.had.co.nz/data-visualisation.html" class="external-link"><em>Grammar of
Graphics</em></a> basiert. Hierbei müssen die Daten in tabellarischer
Form vorliegen, d.h. jede Zeile entspricht einem Datensatz und jede
Spalte einer Variable (“tidy data”).</p>
<p>Die Visualisierung von Daten wird in verschiedene Schichten (z.B.
Punkte, Linien, Balken) und Eigenschaften (z.B. x-Achse, y-Achse, Farbe,
Form) unterteilt. Die Verküpfung von Tabellenspalten mit den Ebenen und
Eigenschaften (d.h. Welche Information wird wie fürs Plotting verwendet)
erfolgt über das Argument <code>mapping =</code> und die
<code>aes()</code> Funktion. Schichten (z.B. Balken, Linien, Punkte)
werden mit <code>geom_*()</code> Funktionen hinzugefügt, wobei die Daten
für die Schicht über das Argument <code>data =</code> übergeben
werden.</p>
<p>Im Folgenden wird ein umfangreiches Beispiel für die Visualisierung
von Daten mit <code>ggplot2</code> gezeigt, bei dem die Anzahl der
Stürme pro Jahr visualisiert wird.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Beispiel: Anzahl der Stürme pro Jahr visualisieren</span></span>
<span></span>
<span><span class="co"># Rohdatensatz startet Visualisierungsworkflow</span></span>
<span><span class="va">storms</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co">########### Datenvorbereitung #############</span></span>
<span></span>
<span>  <span class="co"># auf einen Eintrag (Zeile) pro Sturm und Jahr reduzieren</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">year</span>, <span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Anzahl der Stürme pro Jahr zählen</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co">########### Datenvisualisierung #############</span></span>
<span></span>
<span>  <span class="co"># ggplot-Objekt erstellen (Daten via pipe übergeben)</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Verknüpfung von Datenspalten (year, n) und Achsen (x,y)</span></span>
<span>  <span class="co"># Diagrammtitel und Achsenbeschriftung</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Anzahl der Stürme pro Jahr"</span>, x <span class="op">=</span> <span class="st">"Jahr"</span>, y <span class="op">=</span> <span class="st">"Anzahl"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># grundlegende Diagrammformatierung (Hintergrundfarben, Schriftarten, ...)</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Balkendiagramm mit Anzahl der Stürme pro Jahr</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>fill<span class="op">=</span><span class="st">"skyblue3"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># gepunktete horizontale Linie bei 20</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">20</span>, linetype<span class="op">=</span><span class="st">"dotted"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Highlighting der Jahre mit mehr als 20 Stürmen</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>data <span class="op">=</span> <span class="op">~</span> <span class="fu">filter</span><span class="op">(</span><span class="va">.x</span>, <span class="va">n</span><span class="op">&gt;</span><span class="fl">20</span><span class="op">)</span>,  <span class="co"># Datensatz einschränken</span></span>
<span>            <span class="co"># (hier `.x` = Platzhalter für Daten aus vorheriger Ebene, d.h. `storms`)</span></span>
<span>            <span class="fu">aes</span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">year</span><span class="op">)</span>, <span class="co"># welche (Teil)Tabellendaten für Position zu verwenden</span></span>
<span>            color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Zusätzliche Formatierung</span></span>
<span>  <span class="co"># Jahreszahlen der Jahre mit mehr als 20 Stürmen in schräger Textausrichtung</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="op">~</span> <span class="fu">filter</span><span class="op">(</span><span class="va">.x</span>, <span class="va">n</span><span class="op">&gt;</span><span class="fl">20</span><span class="op">)</span>, <span class="co"># Datensatz einschränken</span></span>
<span>            <span class="fu">aes</span><span class="op">(</span>label<span class="op">=</span><span class="va">year</span>, x<span class="op">=</span><span class="va">year</span>, y<span class="op">=</span><span class="fu">max</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Daten und Positionen festlegen</span></span>
<span>            angle<span class="op">=</span><span class="fl">70</span>, vjust<span class="op">=</span><span class="fl">0.5</span>, hjust<span class="op">=</span><span class="op">-</span><span class="fl">0.6</span>, size<span class="op">=</span><span class="fl">3</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Textformatierung</span></span>
<span>  <span class="co"># disable clipping um Jahreszahltexte außerhalb des Diagrammbereichs anzuzeigen</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/Visualisierung-rendered-ggplot2-examples-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># optional: (zuletzt gemaltes) Diagramm speichern</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="st">"storms_per_year.png"</span>, width<span class="op">=</span><span class="fl">10</span>, height<span class="op">=</span><span class="fl">5</span>, dpi<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span></code></pre>
</div>
<p>Als Nachschlagewerk empfiehlt sich das offizielle Cheat Sheet des
<code>ggplot2</code> Pakets, welches die wichtigsten Funktionen und
Argumente übersichtlich darstellt:</p>
<p><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf" class="external-link"><img src="https://raw.githubusercontent.com/rstudio/cheatsheets/main/pngs/thumbnails/data-visualization-cheatsheet-thumbs.png" style="width:100.0%" alt="CLICK TO ENLARGE: cheat sheet for ggplot2 ackage" class="figure"></a></p>
<div id="sturmposition-visualisieren" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="sturmposition-visualisieren" class="callout-inner">
<h3 class="callout-title">Sturmposition visualisieren</h3>
<div class="callout-content">
<p>Zeichnen sie ein Punktdiagram, welches für folgenden Datensatz</p>
<ul>
<li>Länge (x-Achse) und Breite (y-Achse) der Messung zeigt und die
Punkte anhand des Sturmstatus einfärbt,</li>
<li>die Achsen mit “Länge” und “Breite” beschriftet, und</li>
<li>den Diagrammtitel “Sturmposition” hat.</li>
</ul>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>storms <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">group_by</span>(name,year) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n=</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="co"># .. </span><span class="al">TODO</span><span class="co">: ggplot2 code hier einfügen ..</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">storms</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">name</span>,<span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">slice_tail</span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, color <span class="op">=</span> <span class="va">status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title<span class="op">=</span><span class="st">"Sturmposition"</span>,</span>
<span>    x<span class="op">=</span><span class="st">"Länge"</span>,</span>
<span>    y<span class="op">=</span><span class="st">"Breite"</span>,</span>
<span>    color<span class="op">=</span><span class="st">"Status"</span> <span class="co"># ansonsten klein geschrieben</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/Visualisierung-rendered-ggplot2-exercises-solution-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># alternatively</span></span>
<span><span class="co"># geom_title("Sturmposition") + geom_xlab("Länge") + geom_ylab("Breite") + geom_color("Status")</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>
<code>ggplot2</code> benötigt einen <code>data.frame</code> als
Eingabe, welcher “tidy” ist (d.h. eine Zeile pro Beobachtung und eine
Spalte pro Variable).</li>
<li>Das <code>mapping</code> Argument ermöglicht mittels der
<code>aes()</code> Funktion die Verknüpfung von Variablen des
Datensatzes (d.h. Spaltennamen) mit visuellen Eigenschaften (z.B.
x-Achse, Farbe, Größe).</li>
<li>
<code>geom_*</code> Funktionen fügen dem Plot Schichten hinzu (z.B.
Punkte, Linien, Balken).</li>
<li>
<code>labs()</code> ermöglicht die Anpassung von Diagrammtitel und
Achsenbeschriftung.</li>
<li>
<code>theme_*</code> Funktionen ermöglichen die Anpassung genereller
Diagrammformatierungen (z.B. Hintergrundfarben, Schriftarten).</li>
<li>Es gibt viele weitere Funktionen und Argumente, um die Darstellung
von Diagrammen zu verfeinern (z.B. <code>facet_wrap()</code>,
<code>scale_*</code>, <code>coord_*</code>).</li>
<li>Diagramme mit <code>ggsave()</code> in beliebigem Dateiformat (PNG,
PDF, SVG, ..) speichern.</li>
<li>Ausserdem gibt es viele Erweiterungen für <code>ggplot2</code> (z.B.
<code>ggplotly</code>, <code>ggrepel</code>), die zusätzliche
Funktionalitäten oder Visualisierungstypen/-diagramme bieten.</li>
<li>Zusammenfassung im <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf" class="external-link"><code>ggplot2</code>
Cheat Sheet</a>
</li>
</ul>
</div>
</div>
</div>
<hr>
<p>Dieses Dokument wurde mit Unterstützung von GitHub Copilot erstellt,
einem KI-gestützten Autocompletion-Tool, das auf der OpenAI
GPT-3-Technologie basiert.</p></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/" class="external-link">Source</a></p>
				<p><a href="https://github.com/Dr-Eberle-Zentrum/Python-pandas-compact/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:info@eberle-zentrum.uni-tuebingen.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.7" class="external-link">sandpaper (0.16.7)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/Dr-Eberle-Zentrum/varnish/tree/801bcb40bf3fb18c37950e8d445d79e8aec39af7" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://Dr-Eberle-Zentrum.github.io/Python-pandas-compact/instructor/aio.html",
  "inLanguage": "de",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "Python, pandas, Überblick",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://Dr-Eberle-Zentrum.github.io/Python-pandas-compact/instructor/aio.html",
  "identifier": "https://Dr-Eberle-Zentrum.github.io/Python-pandas-compact/instructor/aio.html",
  "dateCreated": "2024-07-15",
  "dateModified": "2024-10-09",
  "datePublished": "2024-10-09"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

